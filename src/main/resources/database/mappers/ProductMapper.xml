<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
 <mapper namespace="com.home.middle.product.ProductDAO">
 
 	<select id="getProductNum" resultType="Long">
  		SELECT PRODUCT_SEQ.NEXTVAL FROM DUAL
  	</select>
  	
  	
  	<select id="getProductList" resultType="ProductDTO" statementType="PREPARED">
  	SELECT PRODUCTNUM , PRODUCTNAME , DISCOUNT , DISCOUNTPERCENT  FROM PRODUCT
  	
  	</select>
  	
 	<select id="getProductDetail" parameterType="ProductDTO" resultMap="productDetailResult">
	SELECT P.*, PO.* FROM PRODUCT P
	JOIN PRODUCTOPTION PO 
	ON PO.OPTIONNUM  = P.PRODUCTNUM 
	WHERE P.PRODUCTNUM = #{productNum}
   </select> 
 	
 <!--type=""에는 최종리턴타입  -->
   <resultMap type="ProductDTO" id="productDetailResult">
   
	   <!--Primary Key  -->
	   <id column="PRODUCTNUM" property="productNum" />
	   <!-- 그외 나머지 -->
	   <result column="PRODUCTNAME" property="productName" />
	   <result column="DISCOUNT" property="discount" />
	   <result column="DISCOUNTPERCENT" property="discountPercent" />
	   <result column="PRODUCTSALES" property="productSales" />
	   <result column="CATEGORYNUM" property="categoryNum" />
	   
 	   <!-- 1:n 관계일 때  -->
 	   <collection property="productOptionDTO" javaType="ProductOptionDTO">
 	    <id  column="OPTIONNUM"  property="optionNum" />
 	    <result  column="PRODUCTNUM" property="productNum"/>
        <result  column="PRODUCTPRICE" property="productPrice"/>
    	<result  column="PRODUCTSTOCK" property="productStock"/>
    	<result  column="OPTIONNAME" property="optionName"/>
    	<result  column="PRODUCTDATE" property="productDate"/>
    	<result  column="OPTIONVALUE" property="optionValue"/>
    	<result  column="REF" property="ref"/>
    	<result  column="DEPTH" property="depth"/>
    	<result  column="STEP" property="step"/>
 	   </collection>
 	 
 	    <!-- 1:1 관계일 때 -->
    	<!--<association property="" javaType="">-->
   </resultMap>
 </mapper>